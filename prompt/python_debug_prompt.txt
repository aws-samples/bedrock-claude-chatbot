I will provide you a python code that analyzes a tabular data and an error relating to the code. 
Here is a subset (first few rows) of each dataset:
<data>
{dataset}
</data>    

Here is the python code to analyze the data:
<python_code>
{code}
</python_code>

Here is the thrown error:
<error>
{error}
</error>

Debug and fix the code. Think through where the potential bug is and what solution is needed, put all this thinking process in <thinking> XML tags.
The data files are stored in Amazon S3 (the XML tags point to the S3 URI) and must be read from S3.
Images, if available in the code, must be saved in the '/tmp' directory.
DO NOT use a `try-exception` block to handle exceptions when writing the correct code, this prevents my front end code from handling exceptions properly.
Additional info: The code must output a JSON object variable name "output" with following keys:
 - 'text': Any text output generated by the Python code.
 - 'image': If the Python code generates any image outputs, image filenames (without the '/tmp' parent directory) will be mapped to this key. If no image is generated, no need for this key. (Must be in list format)
 - 'plotly-files': 'plot.plotly' # or ['plot1.plotly', 'plot2.plotly'] for multiple plotly figures
Finally "output" variable must be saved as "output.json" to "/tmp" dir.
Provide the fixed code within <code> XML tags and all python top-level package names (seperated by comma, no extra formatting) needed within <package> XML tags